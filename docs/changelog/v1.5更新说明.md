# v1.5 æ›´æ–°è¯´æ˜ - æ ‡é¢˜æ å³ä¾§å›¾æ ‡

## ğŸ“… æ›´æ–°æ—¥æœŸ
2025-10-20

---

## ğŸ¯ æœ¬æ¬¡æ›´æ–°å†…å®¹

### âœ¨ æ–°å¢åŠŸèƒ½

#### æ ‡é¢˜æ å³ä¾§åŠŸèƒ½å›¾æ ‡

åœ¨æ ‡é¢˜æ å³ä¾§ï¼ˆåŸçª—å£æ§åˆ¶æŒ‰é’®ä½ç½®ï¼‰æ·»åŠ äº†ä¸‰ä¸ªåŠŸèƒ½å›¾æ ‡ï¼š

1. **ğŸ’¬ é€šçŸ¥æŒ‰é’®**
   - å›¾æ ‡ï¼šèŠå¤©/æ¶ˆæ¯å›¾æ ‡
   - åŠŸèƒ½ï¼šç‚¹å‡»æ˜¾ç¤ºé€šçŸ¥æç¤º
   - æç¤ºï¼š"æ‚¨æœ‰ 0 æ¡æœªè¯»é€šçŸ¥"

2. **âš™ï¸ è®¾ç½®æŒ‰é’®**
   - å›¾æ ‡ï¼šè®¾ç½®é½¿è½®å›¾æ ‡
   - åŠŸèƒ½ï¼šç‚¹å‡»è·³è½¬åˆ°è®¾ç½®é¡µé¢
   - å¿«æ·è®¿é—®è®¾ç½®åŠŸèƒ½

3. **ğŸ‘¤ ç”¨æˆ·å¤´åƒ**
   - ç»„ä»¶ï¼šåœ†å½¢å¤´åƒ
   - åŠŸèƒ½ï¼šç‚¹å‡»æ˜¾ç¤ºç”¨æˆ·èœå•
   - èœå•é€‰é¡¹ï¼š
     - ä¸ªäººä¿¡æ¯
     - åˆ‡æ¢è´¦å·
     - é€€å‡ºç™»å½•

---

## ğŸ“ ä»£ç å˜æ›´

### å¯¼å…¥æ–°ç»„ä»¶

```python
from qfluentwidgets import (FluentWindow, NavigationItemPosition, MessageBox,
                            SplashScreen, SystemThemeListener, SearchLineEdit,
                            TransparentToolButton, Action, AvatarWidget)
```

**æ–°å¢ç»„ä»¶**ï¼š
- `TransparentToolButton` - é€æ˜å·¥å…·æŒ‰é’®
- `Action` - èœå•åŠ¨ä½œ
- `AvatarWidget` - å¤´åƒç»„ä»¶

### CustomTitleBar æ‰©å±•

#### 1. æ·»åŠ åŠŸèƒ½æŒ‰é’®
```python
# é€šçŸ¥æŒ‰é’®
self.notificationBtn = TransparentToolButton(FIF.CHAT, self)
self.notificationBtn.setFixedSize(46, 32)
self.notificationBtn.setToolTip('é€šçŸ¥')

# è®¾ç½®æŒ‰é’®
self.settingsBtn = TransparentToolButton(FIF.SETTING, self)
self.settingsBtn.setFixedSize(46, 32)
self.settingsBtn.setToolTip('è®¾ç½®')

# ç”¨æˆ·å¤´åƒ
self.avatar = AvatarWidget(parent=self)
self.avatar.setRadius(12)
```

#### 2. æ·»åŠ åˆ°å¸ƒå±€
```python
self.hBoxLayout.addWidget(self.notificationBtn, 0, Qt.AlignmentFlag.AlignRight)
self.hBoxLayout.addWidget(self.settingsBtn, 0, Qt.AlignmentFlag.AlignRight)
self.hBoxLayout.addWidget(self.avatar, 0, Qt.AlignmentFlag.AlignRight)
self.hBoxLayout.addSpacing(10)  # å³ä¾§è¾¹è·
```

#### 3. è¿æ¥ç‚¹å‡»äº‹ä»¶
```python
self.settingsBtn.clicked.connect(self._onSettingsClicked)
self.notificationBtn.clicked.connect(self._onNotificationClicked)
self.avatar.clicked.connect(self._onAvatarClicked)
```

#### 4. å®ç°äº‹ä»¶å¤„ç†æ–¹æ³•

**è®¾ç½®æŒ‰é’®ç‚¹å‡»**ï¼š
```python
def _onSettingsClicked(self):
    """ è®¾ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶ """
    window = self.window()
    if hasattr(window, 'settingInterface'):
        window.switchTo(window.settingInterface)
```

**é€šçŸ¥æŒ‰é’®ç‚¹å‡»**ï¼š
```python
def _onNotificationClicked(self):
    """ é€šçŸ¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶ """
    from qfluentwidgets import InfoBar, InfoBarPosition
    InfoBar.info(
        title='é€šçŸ¥',
        content='æ‚¨æœ‰ 0 æ¡æœªè¯»é€šçŸ¥',
        orient=Qt.Orientation.Horizontal,
        isClosable=True,
        position=InfoBarPosition.TOP_RIGHT,
        duration=2000,
        parent=self.window()
    )
```

**å¤´åƒç‚¹å‡»**ï¼š
```python
def _onAvatarClicked(self):
    """ å¤´åƒç‚¹å‡»äº‹ä»¶ """
    from qfluentwidgets import RoundMenu, Action, MenuAnimationType
    menu = RoundMenu(parent=self)
    menu.addAction(Action(FIF.PEOPLE, 'ä¸ªäººä¿¡æ¯'))
    menu.addAction(Action(FIF.SYNC, 'åˆ‡æ¢è´¦å·'))
    menu.addSeparator()
    menu.addAction(Action(FIF.CLOSE, 'é€€å‡ºç™»å½•'))
    menu.exec(self.avatar.mapToGlobal(self.avatar.rect().bottomLeft()), 
              aniType=MenuAnimationType.DROP_DOWN)
```

---

## ğŸ¨ ç•Œé¢æ•ˆæœ

### æ ‡é¢˜æ å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å›¾æ ‡] [æ ‡é¢˜]  [â”â”â” æœç´¢æ¡† â”â”â”]   [ğŸ’¬] [âš™ï¸] [ğŸ‘¤]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¸ƒå±€è¯´æ˜**ï¼š
- å·¦ä¾§ï¼šçª—å£å›¾æ ‡ + æ ‡é¢˜
- ä¸­é—´ï¼šæœç´¢æ¡†
- å³ä¾§ï¼šé€šçŸ¥æŒ‰é’® + è®¾ç½®æŒ‰é’® + ç”¨æˆ·å¤´åƒ

### æŒ‰é’®æ ·å¼

- **å¤§å°**ï¼š46x32 åƒç´ 
- **æ ·å¼**ï¼šé€æ˜èƒŒæ™¯ï¼Œæ‚¬åœæ—¶é«˜äº®
- **å›¾æ ‡**ï¼šFluent Design å›¾æ ‡ç³»ç»Ÿ
- **æç¤º**ï¼šé¼ æ ‡æ‚¬åœæ˜¾ç¤ºå·¥å…·æç¤º

### å¤´åƒæ ·å¼

- **å½¢çŠ¶**ï¼šåœ†å½¢
- **åŠå¾„**ï¼š12 åƒç´ 
- **å¯ç‚¹å‡»**ï¼šæ˜¾ç¤ºä¸‹æ‹‰èœå•
- **é»˜è®¤**ï¼šä½¿ç”¨ç³»ç»Ÿé»˜è®¤å¤´åƒ

---

## ğŸ”§ äº¤äº’åŠŸèƒ½

### 1. é€šçŸ¥æŒ‰é’®

**ç‚¹å‡»æ•ˆæœ**ï¼š
- åœ¨çª—å£å³ä¸Šè§’æ˜¾ç¤ºä¿¡æ¯æç¤ºæ¡
- æ˜¾ç¤º 2 ç§’åè‡ªåŠ¨æ¶ˆå¤±
- å¯æ‰‹åŠ¨å…³é—­

**å¯æ‰©å±•**ï¼š
- å¯è¿æ¥åˆ°å®é™…çš„é€šçŸ¥ç³»ç»Ÿ
- æ˜¾ç¤ºæœªè¯»é€šçŸ¥æ•°é‡å¾½ç« 
- æ‰“å¼€é€šçŸ¥ä¸­å¿ƒé¢æ¿

### 2. è®¾ç½®æŒ‰é’®

**ç‚¹å‡»æ•ˆæœ**ï¼š
- è‡ªåŠ¨åˆ‡æ¢åˆ°è®¾ç½®é¡µé¢
- ä½¿ç”¨ç°æœ‰çš„è®¾ç½®ç•Œé¢

**å¯æ‰©å±•**ï¼š
- æ‰“å¼€å¿«é€Ÿè®¾ç½®é¢æ¿
- æ˜¾ç¤ºå¸¸ç”¨è®¾ç½®é¡¹

### 3. ç”¨æˆ·å¤´åƒ

**ç‚¹å‡»æ•ˆæœ**ï¼š
- å¼¹å‡ºåœ†è§’ä¸‹æ‹‰èœå•
- ä½¿ç”¨ä¸‹æ‹‰åŠ¨ç”»
- æ˜¾ç¤ºç”¨æˆ·ç›¸å…³é€‰é¡¹

**èœå•é€‰é¡¹**ï¼š
- ä¸ªäººä¿¡æ¯ï¼ˆæŸ¥çœ‹/ç¼–è¾‘ä¸ªäººèµ„æ–™ï¼‰
- åˆ‡æ¢è´¦å·ï¼ˆå¤šè´¦å·åˆ‡æ¢ï¼‰
- é€€å‡ºç™»å½•ï¼ˆé€€å‡ºå½“å‰è´¦å·ï¼‰

**å¯æ‰©å±•**ï¼š
- è®¾ç½®çœŸå®çš„å¤´åƒå›¾ç‰‡
- è¿æ¥åˆ°ç”¨æˆ·ç³»ç»Ÿ
- æ·»åŠ æ›´å¤šèœå•é¡¹

---

## ğŸ’¡ è‡ªå®šä¹‰æŒ‡å—

### æ›´æ”¹å¤´åƒ

```python
# åœ¨ CustomTitleBar.__init__() ä¸­
self.avatar.setImage('path/to/avatar.png')

# æˆ–ä½¿ç”¨ QPixmap
from PyQt6.QtGui import QPixmap
avatar_pixmap = QPixmap('resource/avatar.png')
self.avatar.setImage(avatar_pixmap)

# æˆ–ä½¿ç”¨åŠ¨æ€å›¾ç‰‡ï¼ˆGIFï¼‰
self.avatar.setImage('resource/avatar.gif')
```

### æ·»åŠ æ›´å¤šæŒ‰é’®

```python
# åœ¨é€šçŸ¥æŒ‰é’®ä¹‹å‰æ·»åŠ 
self.searchBtn = TransparentToolButton(FIF.SEARCH, self)
self.searchBtn.setFixedSize(46, 32)
self.searchBtn.setToolTip('å…¨å±€æœç´¢')
self.hBoxLayout.addWidget(self.searchBtn, 0, Qt.AlignmentFlag.AlignRight)
```

### æ˜¾ç¤ºæœªè¯»æ•°é‡å¾½ç« 

```python
from qfluentwidgets import InfoBadge, InfoLevel

# åˆ›å»ºå¾½ç« 
badge = InfoBadge.attension(
    text='5',  # æœªè¯»æ•°é‡
    parent=self.notificationBtn,
    target=self.notificationBtn
)
badge.move(30, 5)  # è°ƒæ•´ä½ç½®
```

### è‡ªå®šä¹‰èœå•

```python
def _onAvatarClicked(self):
    menu = RoundMenu(parent=self)
    
    # æ·»åŠ ç”¨æˆ·ä¿¡æ¯å¤´éƒ¨
    menu.addAction(Action(FIF.PEOPLE, 'å¼ ä¸‰'))
    menu.addSeparator()
    
    # æ·»åŠ æ›´å¤šé€‰é¡¹
    menu.addAction(Action(FIF.SETTING, 'è´¦æˆ·è®¾ç½®'))
    menu.addAction(Action(FIF.HELP, 'å¸®åŠ©ä¸­å¿ƒ'))
    menu.addAction(Action(FIF.FEEDBACK, 'æ„è§åé¦ˆ'))
    menu.addSeparator()
    menu.addAction(Action(FIF.CLOSE, 'é€€å‡ºç™»å½•'))
    
    menu.exec(...)
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### é€‚åˆçš„åº”ç”¨ç±»å‹

- âœ… éœ€è¦ç”¨æˆ·ç™»å½•çš„åº”ç”¨
- âœ… å¤šè´¦å·åˆ‡æ¢åŠŸèƒ½çš„åº”ç”¨
- âœ… éœ€è¦é€šçŸ¥ç³»ç»Ÿçš„åº”ç”¨
- âœ… å¿«é€Ÿè®¿é—®è®¾ç½®çš„åº”ç”¨

### åŠŸèƒ½æ‰©å±•å»ºè®®

1. **é€šçŸ¥ç³»ç»Ÿ**
   - è¿æ¥åˆ°åç«¯é€šçŸ¥æœåŠ¡
   - å®æ—¶æ¨é€æ–°æ¶ˆæ¯
   - æ˜¾ç¤ºæœªè¯»æ•°é‡

2. **ç”¨æˆ·ç³»ç»Ÿ**
   - æ˜¾ç¤ºç”¨æˆ·å¤´åƒå’Œæ˜µç§°
   - æ”¯æŒå¤šè´¦å·ç®¡ç†
   - è´¦å·åˆ‡æ¢åŠŸèƒ½

3. **å¿«é€Ÿæ“ä½œ**
   - æ·»åŠ å¿«æ·åŠŸèƒ½æŒ‰é’®
   - å…¨å±€æœç´¢
   - å¿«é€Ÿè®¾ç½®é¢æ¿

---

## ğŸ“Š å¯¹æ¯”æ•ˆæœ

### v1.4.1
```
æ ‡é¢˜æ å³ä¾§ï¼šç©ºç™½
```

### v1.5
```
æ ‡é¢˜æ å³ä¾§ï¼š[ğŸ’¬ é€šçŸ¥] [âš™ï¸ è®¾ç½®] [ğŸ‘¤ å¤´åƒ]
```

**æ”¹è¿›**ï¼š
- âœ… å……åˆ†åˆ©ç”¨å³ä¾§ç©ºé—´
- âœ… å¿«é€Ÿè®¿é—®å¸¸ç”¨åŠŸèƒ½
- âœ… ç°ä»£åŒ–çš„ç”¨æˆ·ç•Œé¢
- âœ… ç¬¦åˆ Fluent Design è§„èŒƒ

---

## ğŸ” å‚è€ƒæ–‡ä»¶

- [å›¾æ ‡.py](../å›¾æ ‡.py) - å¤´åƒç»„ä»¶ä½¿ç”¨ç¤ºä¾‹
- [æ ·å¼æ¨¡æ¿/app/common/icon.py](../æ ·å¼æ¨¡æ¿/app/common/icon.py) - è‡ªå®šä¹‰å›¾æ ‡å®šä¹‰

---

## âš™ï¸ é…ç½®é€‰é¡¹

### æŒ‰é’®å¤§å°
```python
# å½“å‰ï¼š46x32
# å¯è°ƒæ•´ä¸ºå…¶ä»–å°ºå¯¸
self.notificationBtn.setFixedSize(40, 32)  # æ›´çª„
self.notificationBtn.setFixedSize(50, 36)  # æ›´å®½
```

### å¤´åƒå¤§å°
```python
# å½“å‰ï¼šåŠå¾„12ï¼ˆç›´å¾„24ï¼‰
# å¯è°ƒæ•´ä¸ºå…¶ä»–å°ºå¯¸
self.avatar.setRadius(16)  # æ›´å¤§ï¼ˆç›´å¾„32ï¼‰
self.avatar.setRadius(10)  # æ›´å°ï¼ˆç›´å¾„20ï¼‰
```

### é—´è·è°ƒæ•´
```python
# å³ä¾§è¾¹è·
self.hBoxLayout.addSpacing(20)  # å¢å¤§é—´è·
self.hBoxLayout.addSpacing(5)   # å‡å°é—´è·

# æŒ‰é’®é—´è·
self.hBoxLayout.insertSpacing(4, 10)  # åœ¨æŒ‰é’®ä¹‹é—´æ·»åŠ é—´è·
```

---

**å½“å‰ç‰ˆæœ¬**: v1.5  
**æ›´æ–°ç±»å‹**: åŠŸèƒ½å¢å¼º  
**å…¼å®¹æ€§**: å®Œå…¨å…¼å®¹ v1.4.x
